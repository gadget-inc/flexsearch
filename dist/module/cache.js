import{is_undefined,create_object}from"./common.js";export default function CacheClass(a){this.clear(),this.limit=!0!==a&&a}CacheClass.prototype.clear=function(){this.cache=create_object(),this.count=create_object(),this.index=create_object(),this.ids=[]},CacheClass.prototype.set=function(a,b){if(this.limit&&is_undefined(this.cache[a])){let c=this.ids.length;if(c===this.limit){c--;const a=this.ids[c];delete this.cache[a],delete this.count[a],delete this.index[a]}this.ids[c]=a,this.index[a]=c,this.count[a]=-1,this.cache[a]=b,this.get(a)}else this.cache[a]=b},CacheClass.prototype.get=function(a){const b=this.cache[a];if(this.limit&&b){const b=++this.count[a],c=this.index;let d=c[a];if(0<d){const e=this.ids,f=d;for(;this.count[e[--d]]<=b&&-1!==d;);if(d++,d!==f){for(let a=f;a>d;a--){const b=e[a-1];e[a]=b,c[b]=a}e[d]=a,c[a]=d}}}return b};